#!/bin/bash
#--------------------------------------------------------------------------------
#################################################################################
#--------------------------------------------------------------------------------
DIRECTORY=$(pwd); BASENAME=$(basename "$(pwd)")
#--------------------------------------------------------------------------------
OUTPUT=${BASENAME}; OUTPUT_PATH="zig-out"
#--------------------------------------------------------------------------------
#################################################################################
#--------------------------------------------------------------------------------
if [ -f "Taskfile.yml" ] || [ -f "Taskfile.yaml" ] || [ -f "taskfile.yml" ] || [ -f "taskfile.yaml" ]
then
	#----------------------------------------
	task build
	[ $? -eq 0 ] && task run -- $*
	#----------------------------------------
	exit $?
	#----------------------------------------
elif [ -f "Makefile" ] || [ -f "makefile" ]
then
	#----------------------------------------
	make build
	[ $? -eq 0 ] && make run ARGS="${*}"
	#----------------------------------------
	exit $?
	#----------------------------------------
	fi
#--------------------------------------------------------------------------------
zigbuild
#--------------------------------------------------------------------------------
if [ $? -eq 0 ]
then
	if [ -d "${OUTPUT_PATH}" ] && [ -f "${OUTPUT_PATH}/${OUTPUT}" ]
	then
		cd ${OUTPUT_PATH}
		./${OUTPUT} ${*}
	elif [ -d "${OUTPUT_PATH}" ] && [ -d "${OUTPUT_PATH}/bin" ] && [ -f "${OUTPUT_PATH}/bin/${OUTPUT}" ]
	then
		cd ${OUTPUT_PATH}/bin
		./${OUTPUT} ${*}
	fi
fi
#--------------------------------------------------------------------------------
exit $?
#--------------------------------------------------------------------------------
#################################################################################
#--------------------------------------------------------------------------------
