#!/bin/bash
#--------------------------------------------------------------------------------
#################################################################################
#--------------------------------------------------------------------------------
[ "${ZIG_BUILD_MODE}" == "" ] && ZIG_BUILD_MODE="ReleaseSmall"
#--------------------------------------------------------------------------------
#################################################################################
#--------------------------------------------------------------------------------
DIRECTORY=$(pwd)
#--------------------------------------------------------------------------------
BASENAME=$(basename "$(pwd)")
#--------------------------------------------------------------------------------
SOURCE=""
#--------------------------------------------------------------------------------
#################################################################################
#--------------------------------------------------------------------------------
if [ -f "Taskfile.yml" ] || [ -f "Taskfile.yaml" ] || [ -f "taskfile.yml" ] || [ -f "taskfile.yaml" ]
then
	#----------------------------------------
	task run -- ${*}
	#----------------------------------------
	exit $?
	#----------------------------------------
elif [ -f "Makefile" ] || [ -f "makefile" ]
then
	#----------------------------------------
	make run ARGS="${*}"
	#----------------------------------------
	exit $?
	#----------------------------------------
elif [ -f "main.zig" ]
then
	#----------------------------------------
	SOURCE="main.zig"
	#----------------------------------------
elif [ -f "root.zig" ]
then
	#----------------------------------------
	SOURCE="root.zig"
	#----------------------------------------
else
	#----------------------------------------
	if [ -f "${BASENAME}.zig" ]
	then
		#----------------------------------------
		SOURCE="${BASENAME}.zig"
		#----------------------------------------
	else
		#----------------------------------------
		echo "unknown source filename"
		exit 1
		#----------------------------------------
	fi
	#----------------------------------------
fi
#--------------------------------------------------------------------------------
#################################################################################
#--------------------------------------------------------------------------------
if [ -f "${SOURCE}" ]
then
	#----------------------------------------
	zig run ${SOURCE} -O ${ZIG_BUILD_MODE} -- ${*}
	#----------------------------------------
else
	#----------------------------------------
	echo "unknown source filename"
	#----------------------------------------
fi
#--------------------------------------------------------------------------------
#################################################################################
#--------------------------------------------------------------------------------

